rcan_version: "1.0.0-alpha"

metadata:
  robot_name: "Makeblock_mBot"
  robot_uuid: "00000000-0000-0000-0000-000000000013"
  author: "OpenCastor Default"
  license: "Apache-2.0"
  tags:
    - mobile
    - educational
    - makeblock
    - mbot
    - arduino
    - stem
    - second-hand
  description: >
    Makeblock mBot — one of the most popular STEM toy robots ever made (~$50 new).
    Abundantly available on eBay, Amazon Warehouse, and Goodwill. Based on the
    Makeblock Orion board (Arduino Mega-compatible) with integrated TB6612FNG dual
    motor driver. Connects via USB serial, 2.4GHz wireless module, or BLE dongle.
    Two DC gearmotors (6V, 200 RPM), ultrasonic sensor, line-follower sensor, buzzer.

agent:
  provider: "anthropic"
  model: "claude-sonnet-4-5"
  vision_enabled: false
  latency_budget_ms: 200
  safety_stop: true

physics:
  type: "differential_drive"
  dof: 2
  chassis:
    wheel_base_mm: 170
    wheel_radius_mm: 26

drivers:
  - id: "motor_driver"
    protocol: "makeblock_serial"
    # Uses Makeblock Scratch Firmware + mCore protocol over serial
    port: "/dev/ttyUSB0"    # Linux; macOS: /dev/cu.wchusbserial*; Win: COMx
    baud: 115200
    channels:
      left_motor: 1         # M1 on mCore board
      right_motor: 2        # M2 on mCore board (inverted)
    motor_voltage_v: 6.0
    max_pwm: 255

  - id: "ultrasonic_sensor"
    protocol: "makeblock_serial"
    port: "/dev/ttyUSB0"
    baud: 115200
    sensor_type: "ultrasonic"
    mcore_port: 3           # RJ25 port 3

  - id: "line_follower"
    protocol: "makeblock_serial"
    port: "/dev/ttyUSB0"
    baud: 115200
    sensor_type: "line_follower"
    mcore_port: 2

  - id: "rgb_led"
    protocol: "makeblock_serial"
    port: "/dev/ttyUSB0"
    baud: 115200
    sensor_type: "on_board_rgb"

  - id: "buzzer"
    protocol: "makeblock_serial"
    port: "/dev/ttyUSB0"
    baud: 115200
    sensor_type: "buzzer"

connection:
  type: "serial"
  port: "/dev/ttyUSB0"
  baud: 115200
  # Alternative: BLE via HC-06 module (baud 9600)
  ble_alternative:
    enabled: false
    baud: 9600

network:
  telemetry_stream: true
  sim_to_real_sync: false
  allow_remote_override: true

rcan_protocol:
  port: 8000
  capabilities: [status, nav, teleop, chat]
  enable_mdns: false
  enable_jwt: false

notes:
  setup: >
    1. Install mBlock 5 or Arduino IDE with Makeblock libraries.
    2. Flash the "Makeblock default firmware" (Scratch firmware) to the mCore.
       This firmware accepts the serial command protocol OpenCastor uses.
    3. pip install pyserial makeblock (community Python library)
    4. castor run --config makeblock_mbot.rcan.yaml
  second_hand_tips: >
    Check that the USB-B port on the mCore board is not damaged (very common).
    The Orion board is the older larger version; mCore is the integrated newer one.
    Both are compatible with this preset. BLE 2.4G modules can be missing — USB
    serial always works as a fallback.
